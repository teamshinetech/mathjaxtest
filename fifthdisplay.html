<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta content="telephone=no" name="format-detection"/>
    <title>Display 5</title>
    <style>
        body {
            background-color: #eeeeee;
        }

        * {
            box-sizing: border-box;
        }
    </style>
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]}
    });
    </script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML-full">
    </script>
    <script src="./vue.js"></script>
    <!--<script src="https://unpkg.com/vue/dist/vue.js"></script>-->
    <!--<script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>-->
</head>
<body>
<article class="container" id="app">
    <section class="title">
        <p>{{description}}</p>
    </section>
    <section class="answer">
        <div class="item">
            <button>{{answers[currentDisplayIndex].displayValue}}</button>
        </div>
    </section>
    <section class="questions">
        <div class="item" v-for="question in questions">
            <button>{{question.displayValue}}</button>
        </div>
    </section>
</article>
<script>
    var dataSource = {
        CorrectAnswer: ">1/2|<1/2|1/2",
        DescriptionText: "Drop each fraction in the right circle!",
        Display1: "$${7 \over 12}$$|$${6 \over 14}$$|$${8 \over 16}$$",
        Display2: "$$< {1 \over 2}$$|$$> {1 \over 2}$$|$${1 \over 2}$$",
        Display2RawValue: "<1/2|>1/2|1/2"
    };

    function updateData(data) {
        var updatedData = initializeData(data);
        app.$data.answers = updatedData.answers;
        app.$data.questions = updatedData.questions;
    }

    function sendMessageToNative(message) {
        try {
            window.webkit.messageHandlers.submit.postMessage(message);
        } catch (ex) {
            throw Error(ex);
        }
    }

    function initializeData(data) {
        var transferredDisplay1 = data.Display1.replace(/\\*over/g, '\\over');
        var transferredDisplay2 = data.Display2.replace(/\\*over/g, '\\over');
        var display1StringArray = transferredDisplay1.split('|');
        var display2StringArray = transferredDisplay2.split('|');
        var correctAnswers = data.CorrectAnswer.split('|');
        var display2RawValueArray = data.Display2RawValue.split('|');
        var answers = [];
        var questions = [];
        for (var i = 0; i < correctAnswers.length; i++) {
            var answerItem = {displayValue: display1StringArray[i], correctValue: correctAnswers[i]};
            var questionItem = {displayValue: display2StringArray[i], rawValue: display2RawValueArray[i]};
            answers.push(answerItem);
            questions.push(questionItem);
        }
        return ({
            description: data.DescriptionText,
            answers: answers,
            questions: questions
        })
    }
    var modifiedData = initializeData(dataSource);
    console.log("data " + JSON.stringify(modifiedData));
    var app = new Vue({
        el: '#app',
        data: {
            currentDisplayIndex: 0,
            hasFilledOut: false,
            answers: modifiedData.answers,
            questions: modifiedData.questions,
            description: modifiedData.description
        },
        methods: {
            moveIntoNextQuestion: function () {
                this.currentDisplayIndex++;
            }
        }
    })
</script>
</body>
</html>